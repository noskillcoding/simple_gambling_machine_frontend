**Цель:** Разработать интуитивно понятный, функциональный и эстетически привлекательный пользовательский интерфейс для "Simple Gambling Machine", используя `shadcn/ui` для компонентов и следуя современным практикам веб-разработки, с учетом полной децентрализации и прозрачности проекта.

**1. Общие требования:**
*   **Адаптивный дизайн:** Полная поддержка десктопных, планшетных и мобильных устройств.
*   **Производительность:** Быстрая загрузка и плавное взаимодействие.
*   **Доступность:** Соблюдение базовых принципов доступности.
*   **UX/UI:** Интуитивно понятный интерфейс, чистый и современный дизайн.
*   **Контракт:** Адрес контракта на Ethereum Mainnet: `0x01567Fd0e93004B1af30a86DD590A591c8aA72FC`.
*   Интерфейс должен быть на английском языке.

**2. Структура данных (для будущего фронтенда) - Добавлены детали из ABI:**

Нам потребуется получать следующие данные из смарт-контракта (ABI предоставляет все необходимые функции `view`):

*   **Contract State Data:**
    *   `ethInMachine` (можно получить из `provider.getBalance(CONTRACT_ADDRESS)`): Текущий баланс ETH в контракте.
    *   `timeLeftSeconds` (рассчитывается на клиенте: `_currentTimeout` - (currentTime - `lastDepositTime`)): Оставшееся время в секундах до окончания раунда.
    *   `requiredDepositEth` (`nextRequiredDeposit()`): Требуемая сумма депозита в ETH для следующего вклада.
    *   `lastDepositorAddress` (`lastDepositor()`): Адрес последнего вкладчика.
    *   `totalDepositsCount` (`depositCount()`): Общее количество депозитов в текущем раунде.
    *   `lastDepositTime` (`lastDepositTime()`): Временная метка последнего депозита (для расчета таймера).
    *   `currentTimeoutSecs` (`_currentTimeout()`): Текущая длина тайм-аута в секундах, зависящая от количества депозитов.
    *   `INITIAL_BALANCE`: Начальный баланс контракта (полезно для понимания).
    *   `MAX_ENTRIES`: Максимальное количество депозитов в раунде.
    *   `WINNER_BPS`: Доля победителя (80%).
    *   `RANDOM_TOTAL_BPS`: Общая доля случайных победителей (10%).

*   **User Wallet Data (после подключения):**
    *   `userAddress`: Адрес подключенного кошелька пользователя.
    *   `userEthBalance`: Баланс ETH пользователя.
    *   `isConnected`: Булево значение, указывающее, подключен ли кошелек.
    *   `userDepositsCount`: Количество депозитов, сделанных текущим пользователем (нужно будет получать из логов событий `DepositMade` по адресу пользователя, или если контракт предоставит соответствующую `view` функцию, которой нет в текущем ABI).
    *   `canClaimReward`: Булево значение, может ли пользователь заявить награду (если игра окончена, и он является `lastDepositor` или одним из 5 случайных победителей. Логика определения "случайных победителей" будет сложной на фронтенде без дополнительной `view` функции в контракте или индексации). **Пока считать, что `canClaimReward` активируется только для последнего вкладчика, когда игра завершена и таймер истек, или для любого, кто может завершить игру.**

*   **Game Rules/Tier Data (на основе `depositBps` и `timeoutSecs` по `depositLimits`):**
    *   Массив объектов `DepositTier`, который, вероятно, будет хардкодиться на фронтенде или рассчитываться на основе данных из контракта:
        ```typescript
        interface DepositTier {
          tier: number;
          minDeposits: number;
          maxDeposits?: number;
          depositPercentage: number; // e.g., 2 for 2% (derived from depositBps)
          timeoutHours: number; // e.g., 24 for 24 hours (derived from timeoutSecs)
        }
        ```
        Нам нужно будет вызывать `depositLimits(index)` и `timeoutSecs(index)` для каждого тира, а также `depositBps(depositCount)` для текущего процента.

*   **Transaction Status:**
    *   Состояние отправленной транзакции (pending, success, error).

**3. Структура макета (Page Layout):**

*   **Навигационная панель (Header):**
    *   **Логотип/Название:** "Simple Gambling Machine" (большой, заметный).
    *   **Кнопка "Connect Wallet":** Расположена справа. При подключении кошелька отображать сокращенный адрес (например, `0xAbc...123`).
        *   При нажатии на подключенный кошелек: `DropdownMenu` с опциями "Disconnect" и "View on Etherscan".
*   **Основная секция (Main Content):**
    *   Разделение на 2-3 логических блока (например, "Игра", "Правила", "Информация").
    *   Использование `Container` для ограничения ширины контента.
*   **Футер (Footer):**
    *   Ссылка на исходный код фронтенда (GitHub).
    *   Ссылка на исходный код контракта (GitHub).
    *   Ссылка на Etherscan для контракта.
    *   Ссылка на статью о проекте.
    *   Авторские права.

**4. Компоненты UI (с использованием `shadcn/ui`):**

*   **Button:** Для всех интерактивных кнопок.
*   **Card:** Для группировки информации (например, "Game State", "Game Rules", "Safety & Audits").
*   **Dialog/Sheet:** Для модальных окон (для подтверждения транзакции, детального объяснения правил).
*   **Tooltip:** Для подсказок при наведении на элементы.
*   **Progress:** Для отображения прогресса таймера.
*   **Table:** Для "Deposits Structure".
*   **Input:** Если потребуется поле для ввода суммы депозита (сейчас авто-рассчитывается).
*   **Toast:** Для уведомлений о статусе транзакций (успех, ошибка, ожидание).
*   **Dropdown Menu:** Для опций подключенного кошелька.
*   **Skeleton:** Для состояния загрузки данных.
*   **Accordion:** Для секции "FAQ" и "О безопасности".
*   **Alert/Alert Description:** Для предупреждений (например, "Use at your own risk", "On-chain randomness isn't truly random").

**5. Разделы и функционал:**

*   **a. Секция "Игра" (Game State & Interaction):**
    *   Центральный и самый важный раздел.
    *   **Визуальный элемент:** Анимированный слот-автомат или другой привлекательный визуализатор, который меняет состояние (например, барабаны вращаются при депозите, или "игра окончена").
    *   **Текущий пул (ETH in the Machine):** Крупно отображать текущий баланс контракта.
    *   **Таймер (Time Left):**
        *   Отображать оставшееся время (например, "XXh YYm ZZs").
        *   Использовать `Progress` компонент, который визуально показывает, сколько времени осталось. Цвет прогресса может меняться по мере приближения к нулю.
        *   При достижении нуля - текст "Game Ended".
    *   **Следующий депозит (Required Deposit):** Отображать точную сумму ETH.
    *   **Общее количество депозитов (Total Deposits):** Отображать текущее количество.
    *   **Последний вкладчик (Last Depositor):** Отображать сокращенный адрес с `Tooltip` при наведении (для полного адреса) и кнопкой `Copy` или ссылкой на Etherscan.
    *   **Кнопка "Deposit":**
        *   Яркая, заметная кнопка.
        *   Активна только при подключенном кошельке и если игра не окончена.
        *   При нажатии: `Dialog` для подтверждения транзакции, отображающий сумму, предполагаемые комиссии, и предупреждение "Always check contract address".
        *   Индикация состояния транзакции (`Toast` и/или спиннер на кнопке).
    *   **Кнопка "Claim Reward / End Game":**
        *   Текст кнопки может меняться: "Claim Reward" (если пользователь является победителем) или "End Game" (если любой может завершить раунд).
        *   Активна только когда таймер истек.
        *   При нажатии: `Dialog` для подтверждения транзакции.
        *   После успешного клейма/завершения, игра должна сброситься для нового раунда.
    *   **Кнопка "Refresh Data":** Для принудительного обновления данных из контракта. (Дополнительно, автоматическое обновление каждые X секунд).

*   **b. Секция "Как это работает" (How It Works / Game Rules):**
    *   Заголовок: "How It Works".
    *   Использовать `Accordion` или `Collapsible` для каждого пункта, чтобы не перегружать страницу:
        *   "What is it about?"
        *   "How to gamble?"
        *   "How can I win?"
        *   "When will the game end?"
        *   **Таблица "Deposits Structure":**
            *   Использовать `Table` для отображения всех уровней депозитов, с указанием диапазонов, % депозита и тайм-аутов.
            *   Можно выделить текущий активный тир (если `totalDepositsCount` попадает в него).

*   **c. Секция "Прозрачность и безопасность" (Transparency & Safety):**
    *   Заголовок: "Transparency & Safety".
    *   Использовать `Accordion` для каждого пункта.
    *   **"Is it safe?":**
        *   Акцентировать, что "fully on-chain and immutable".
        *   Перечислить пункты с ссылками:
            1.  Deployed address.
            2.  Verified source code on Etherscan.
            3.  Frontend is open-source.
            4.  Hosted on IPFS.
            5.  **Важное предупреждение:** "Always check the contract address in your wallet before confirming any transaction." (выделить).
    *   **"Casino wins as always, right?":** "No. Only depositors win. No fees."
    *   **"Is the smart contract audited?":**
        *   "No. Use at your own risk." (выделить `Alert` компонентом).
        *   "The code is pretty simple though, you can find it on GitHub and Etherscan." (ссылки).
    *   **"No vulnerabilities, right?":**
        *   Подробное объяснение уязвимости с "on-chain randomness" и ее последствий.
        *   "But you have to win the game first anyway, and it’s tricky and everyone will know you’re a hacker." (можно в виде `Tooltip` или отдельного абзаца).

*   **d. Секция "О проекте" (About the Project):**
    *   Заголовок: "About the Project".
    *   **"Why is the frontend so shitty?":** (Можно перефразировать на "Why this project?")
        *   Ссылка на статью с историей создания.
        *   "Contributions welcome" с ссылкой на GitHub.

**6. Состояния пользовательского интерфейса (UI States):**

*   **Начальное состояние (не подключен):**
    *   Большая кнопка "Connect Wallet" в шапке и, возможно, центральный призыв к действию.
    *   Кнопки "Deposit" и "Claim Reward / End Game" неактивны, с `Tooltip` "Connect wallet to interact".
*   **Кошелек подключен:**
    *   В шапке отображается сокращенный адрес кошелька пользователя.
    *   Кнопки "Deposit" и "Claim Reward / End Game" активны (если применимо).
*   **Ожидание данных контракта:** Отображение `Skeleton` или загрузчика для данных.
*   **Транзакция в процессе:** Модальное окно или `Toast` с индикатором загрузки и сообщениями: "Sending transaction...", "Waiting for confirmation...". Блокировка интерактивных элементов.
*   **Успешная транзакция:** `Toast` "Transaction successful!". Обновление данных.
*   **Ошибка транзакции:** `Toast` "Transaction failed: [Error Message]".
*   **Таймер истек:** Визуальное изменение таймера (например, красный цвет, "Game Ended").
*   **Игра окончена:** Кнопка "Deposit" становится неактивной. Кнопка "Claim Reward / End Game" активируется.

**7. Взаимодействие с контрактом (с использованием `wagmi`/`viem`):**

*   Использование хуков `wagmi` (`useContractRead`, `useContractWrite`, `useBalance`, `useAccount`, `useConnect`, `useDisconnect`).
*   Чтение данных:
    *   `getBalance(CONTRACT_ADDRESS)` для `ethInMachine`.
    *   `readContract` для `nextRequiredDeposit`, `lastDepositor`, `depositCount`, `lastDepositTime`, `_currentTimeout`.
    *   Определить `depositLimits`, `depositBps`, `timeoutSecs` для построения таблицы тиров.
*   Запись данных:
    *   `writeContract` для `deposit` (с `value` равным `requiredDepositEth`).
    *   `writeContract` для `claimTimeout`.
*   Обработка событий: Опционально, если нужно отслеживать события `DepositMade`, `GameWon`, `RandomReward` для отображения истории или других уведомлений.
